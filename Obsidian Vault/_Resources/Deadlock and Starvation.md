[[Thread]]
#многопоточность
### Deadlock (Взаимная Блокировка)

Deadlock, или взаимная блокировка, это ситуация в многопоточном программировании, когда два или более потоков блокируют друг друга, ожидая ресурсов, занятых друг другом. В результате все заблокированные потоки останавливаются и не могут продолжить выполнение.

#### Как Происходит Deadlock

Для возникновения взаимной блокировки должны быть выполнены четыре условия:

1. **Взаимное Исключение (Mutual Exclusion)**: По крайней мере один ресурс должен быть неделимым и может быть использован только одним потоком в одно и то же время.
2. **Держать и Ждать (Hold and Wait)**: Поток, уже удерживающий ресурс, может запрашивать другие ресурсы, которые удерживаются другими потоками.
3. **Нет Отзыва (No Preemption)**: Ресурс не может быть принудительно изъят у потока; поток должен освободить ресурс добровольно.
4. **Циклическое Ожидание (Circular Wait)**: Существует цепочка потоков, каждый из которых ожидает ресурс, удерживаемый следующим участником цепи.

#### Пример Deadlock

Представим ситуацию с двумя потоками (A и B) и двумя ресурсами (R1 и R2):

1. Поток A захватывает ресурс R1.
2. Поток B захватывает ресурс R2.
3. Поток A пытается захватить ресурс R2, но не может, так как он уже занят потоком B.
4. Поток B пытается захватить ресурс R1, но не может, так как он уже занят потоком A.
5. Оба потока оказываются заблокированными и ждут друг друга, образуя взаимную блокировку.

### Starvation (Голодание)

Starvation, или голодание, это состояние, в котором один или несколько потоков не могут получить доступ к ресурсам, необходимым для их выполнения, потому что эти ресурсы постоянно заняты другими потоками. В отличие от взаимной блокировки, где потоки полностью останавливаются, при голодании потоки могут продолжать выполняться, но они не могут продвигаться вперед из-за непрерывного ожидания ресурсов.

#### Как Происходит Starvation

Голодание обычно происходит из-за несправедливого управления ресурсами. Некоторые причины могут включать:

- **Приоритеты**: Высокоприоритетные потоки постоянно получают доступ к ресурсам, в то время как низкоприоритетные потоки остаются без ресурсов.
- **Жадное Удержание Ресурсов**: Некоторые потоки удерживают ресурсы дольше, чем нужно, предотвращая доступ других потоков.
- **Неограниченная Очередь Запросов**: Если запросы на ресурсы обрабатываются в порядке поступления, потоки, отправляющие запросы позже, могут никогда не получить доступ к ресурсам.

#### Пример Starvation

Представим систему с несколькими потоками, где одни потоки имеют высокий приоритет, а другие — низкий. Если система постоянно предоставляет доступ к ресурсам высокоприоритетным потокам, низкоприоритетные потоки могут никогда не получить возможность использовать эти ресурсы, даже если они готовы к выполнению.

### Решения

- **Deadlock**: Для предотвращения взаимной блокировки можно попытаться устранить одно или несколько из четырех условий, необходимых для ее возникновения. Это может включать использование алгоритмов распределения ресурсов, предотвращение циклического ожидания и т.д.
- **Starvation**: Для решения проблемы голодания можно использовать справедливые алгоритмы планирования, гарантирующие, что каждый поток получит доступ к необходимым ресурсам в разумные сроки. Это может включать техники, такие как "честная очередь" (fair queueing) или временные кванты для ограничения времени удержания ресурсов.

Обе проблемы требуют тщательного планирования и разработки архитектуры системы для их предотвращения и решения.