Затирание типов (Type Erasure) в Swift — это техника, позволяющая работать с обобщёнными типами, когда конкретный тип данных неизвестен во время компиляции или когда необходимо предоставить более универсальный API. Это полезно в ситуациях, когда нужно обойти ограничения связанные с обобщенными типами или когда требуется скрыть подробности реализации.

Swift строго типизированный язык, и в нём необходимо указывать типы явно. Однако, иногда это может быть ограничивающим, особенно когда работаешь с обобщёнными протоколами. Протоколы в Swift могут быть обобщёнными, но не могут быть использованы как самостоятельные типы, если они содержат ассоциированные типы или обобщённые методы. Затирание типов помогает обойти эту проблему.

### Пример без затирания типов:

Допустим, у нас есть обобщённый протокол:

```swift
protocol Storage {
    associatedtype Item
    func store(item: Item)
    func retrieve() -> Item
}
```

Если мы захотим использовать `Storage` в качестве типа переменной, то столкнёмся с проблемой:

```swift
var storage: Storage // Ошибка: Протокол 'Storage' не может быть использован в качестве типа
```

### Пример с затиранием типов:

Мы можем создать обёртку, которая "затирает" конкретный тип, реализующий протокол `Storage`, позволяя использовать его более гибко:

```swift
class AnyStorage<Item>: Storage {
    private let _store: (Item) -> Void
    private let _retrieve: () -> Item

    init<U: Storage>(_ storage: U) where U.Item == Item {
        _store = storage.store
        _retrieve = storage.retrieve
    }

    func store(item: Item) {
        _store(item)
    }

    func retrieve() -> Item {
        _retrieve()
    }
}
```

Теперь `AnyStorage` можно использовать для создания переменных типа `Storage` без необходимости указывать конкретный тип:

```swift
struct IntStorage: Storage {
    typealias Item = Int
    private var item: Item?

    func store(item: Item) {
        self.item = item
    }

    func retrieve() -> Item {
        item ?? 0
    }
}

var storage: AnyStorage<Int> = AnyStorage(IntStorage())
```

В этом примере `AnyStorage` обеспечивает затирание типов для `Storage`, позволяя нам использовать переменную `storage` без знания о конкретной реализации `Storage`, которая хранит `Int`.

Затирание типов является мощной функцией в Swift, позволяющей создавать гибкие и масштабируемые API, скрывая детали реализации и облегчая работу с обобщёнными типами.